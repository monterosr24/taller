<div class="container">
    <div class="header">
        <h1>{{ isEditMode ? 'Editar Trabajo' : 'Nuevo Trabajo' }}</h1>
    </div>

    <mat-card>
        <mat-card-content>
            <form [formGroup]="jobForm" (ngSubmit)="onSubmit()">

                <!-- Vehicle Selection -->
                <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Vehículo</mat-label>
                    <mat-select formControlName="vehicleId">
                        <mat-option *ngFor="let vehicle of vehicles" [value]="vehicle.id">
                            {{ getVehicleDisplayName(vehicle) }}
                        </mat-option>
                    </mat-select>
                    <mat-icon matPrefix>directions_car</mat-icon>
                    <mat-error *ngIf="jobForm.get('vehicleId')?.hasError('required')">
                        Selecciona un vehículo
                    </mat-error>
                </mat-form-field>

                <!-- Worker Selection -->
                <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Trabajador Asignado</mat-label>
                    <mat-select formControlName="workerId">
                        <mat-option *ngFor="let worker of workers" [value]="worker.id">
                            {{ getWorkerDisplayName(worker) }}
                        </mat-option>
                    </mat-select>
                    <mat-icon matPrefix>person</mat-icon>
                    <mat-error *ngIf="jobForm.get('workerId')?.hasError('required')">
                        Selecciona un trabajador
                    </mat-error>
                </mat-form-field>

                <!-- Description -->
                <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Descripción del Trabajo</mat-label>
                    <textarea matInput formControlName="description" rows="4"
                        placeholder="Describe el trabajo a realizar..."></textarea>
                    <mat-icon matPrefix>description</mat-icon>
                    <mat-error *ngIf="jobForm.get('description')?.hasError('required')">
                        La descripción es requerida
                    </mat-error>
                    <mat-error *ngIf="jobForm.get('description')?.hasError('maxlength')">
                        Máximo 500 caracteres
                    </mat-error>
                </mat-form-field>

                <!-- Total Amount -->
                <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Monto Total</mat-label>
                    <input matInput type="number" formControlName="totalAmount" placeholder="0.00" step="0.01">
                    <span matPrefix>$&nbsp;</span>
                    <mat-icon matSuffix>attach_money</mat-icon>
                    <mat-error *ngIf="jobForm.get('totalAmount')?.hasError('required')">
                        El monto es requerido
                    </mat-error>
                    <mat-error *ngIf="jobForm.get('totalAmount')?.hasError('min')">
                        El monto debe ser mayor a 0
                    </mat-error>
                </mat-form-field>

                <!-- Status -->
                <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Estado</mat-label>
                    <mat-select formControlName="status">
                        <mat-option *ngFor="let status of statusOptions" [value]="status.value">
                            {{ status.label }}
                        </mat-option>
                    </mat-select>
                    <mat-icon matPrefix>timeline</mat-icon>
                </mat-form-field>

                <!-- Date Range -->
                <div class="date-range">
                    <mat-form-field appearance="outline" class="half-width">
                        <mat-label>Fecha de Inicio</mat-label>
                        <input matInput [matDatepicker]="startPicker" formControlName="startDate">
                        <mat-datepicker-toggle matSuffix [for]="startPicker"></mat-datepicker-toggle>
                        <mat-datepicker #startPicker></mat-datepicker>
                    </mat-form-field>

                    <mat-form-field appearance="outline" class="half-width">
                        <mat-label>Fecha de Finalización</mat-label>
                        <input matInput [matDatepicker]="endPicker" formControlName="endDate">
                        <mat-datepicker-toggle matSuffix [for]="endPicker"></mat-datepicker-toggle>
                        <mat-datepicker #endPicker></mat-datepicker>
                    </mat-form-field>
                </div>

                <!-- Action Buttons -->
                <div class="actions">
                    <button mat-button type="button" (click)="cancel()">
                        Cancelar
                    </button>
                    <button mat-raised-button color="primary" type="submit" [disabled]="!jobForm.valid || loading">
                        <mat-icon>save</mat-icon>
                        {{ isEditMode ? 'Actualizar' : 'Crear' }} Trabajo
                    </button>
                </div>
            </form>
        </mat-card-content>
    </mat-card>
</div>