<div class="vacation-list-container">
    <div class="header">
        <h1>Vacaciones</h1>
        <button mat-raised-button color="primary" (click)="createVacation()">
            <mat-icon>add</mat-icon>
            Solicitar Vacaciones
        </button>
    </div>

    <div *ngIf="loading" class="loading">
        <mat-spinner></mat-spinner>
    </div>

    <div class="table-container" *ngIf="!loading">
        <table mat-table [dataSource]="vacations" class="mat-elevation-z8">

            <!-- ID Column -->
            <ng-container matColumnDef="id">
                <th mat-header-cell *matHeaderCellDef>ID</th>
                <td mat-cell *matCellDef="let vacation">{{ vacation.id }}</td>
            </ng-container>

            <!-- Worker Column -->
            <ng-container matColumnDef="worker">
                <th mat-header-cell *matHeaderCellDef>Trabajador</th>
                <td mat-cell *matCellDef="let vacation">
                    <div class="worker-info">
                        <mat-icon class="info-icon">person</mat-icon>
                        {{ vacation.workerName }}
                    </div>
                </td>
            </ng-container>

            <!-- Start Date Column -->
            <ng-container matColumnDef="startDate">
                <th mat-header-cell *matHeaderCellDef>Fecha Inicio</th>
                <td mat-cell *matCellDef="let vacation">{{ vacation.startDate | date:'short' }}</td>
            </ng-container>

            <!-- End Date Column -->
            <ng-container matColumnDef="endDate">
                <th mat-header-cell *matHeaderCellDef>Fecha Fin</th>
                <td mat-cell *matCellDef="let vacation">{{ vacation.endDate | date:'short' }}</td>
            </ng-container>

            <!-- Total Days Column -->
            <ng-container matColumnDef="totalDays">
                <th mat-header-cell *matHeaderCellDef>Días</th>
                <td mat-cell *matCellDef="let vacation">
                    <span class="days-badge">{{ vacation.totalDays }}</span>
                </td>
            </ng-container>

            <!-- Status Column -->
            <ng-container matColumnDef="status">
                <th mat-header-cell *matHeaderCellDef>Estado</th>
                <td mat-cell *matCellDef="let vacation">
                    <span class="status-badge status-{{vacation.status}}">
                        {{ getStatusLabel(vacation.status) }}
                    </span>
                </td>
            </ng-container>

            <!-- Actions Column -->
            <ng-container matColumnDef="actions">
                <th mat-header-cell *matHeaderCellDef>Acciones</th>
                <td mat-cell *matCellDef="let vacation">
                    <button mat-icon-button [matMenuTriggerFor]="menu" color="primary">
                        <mat-icon>more_vert</mat-icon>
                    </button>
                    <mat-menu #menu="matMenu">
                        <button mat-menu-item (click)="editVacation(vacation.id)"
                            [disabled]="vacation.status === 'approved' || vacation.status === 'completed'">
                            <mat-icon>edit</mat-icon>
                            <span>Editar</span>
                        </button>
                        <button mat-menu-item (click)="approveVacation(vacation.id)"
                            [disabled]="vacation.status !== 'requested'">
                            <mat-icon>check_circle</mat-icon>
                            <span>Aprobar</span>
                        </button>
                        <button mat-menu-item (click)="rejectVacation(vacation.id)"
                            [disabled]="vacation.status !== 'requested'">
                            <mat-icon>cancel</mat-icon>
                            <span>Rechazar</span>
                        </button>
                        <button mat-menu-item (click)="deleteVacation(vacation.id)" class="delete-option">
                            <mat-icon>delete</mat-icon>
                            <span>Eliminar</span>
                        </button>
                    </mat-menu>
                </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

            <!-- No data row -->
            <tr class="mat-row" *matNoDataRow>
                <td class="mat-cell" [attr.colspan]="displayedColumns.length">
                    <div class="no-data">
                        <mat-icon>beach_access</mat-icon>
                        <p>No hay vacaciones registradas</p>
                        <button mat-raised-button color="primary" (click)="createVacation()">
                            Solicitar Primera Vacación
                        </button>
                    </div>
                </td>
            </tr>
        </table>
    </div>
</div>